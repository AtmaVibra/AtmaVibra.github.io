/* ============================
   MÓVIL
============================ */

const mobileContainer = document.getElementById("mobileCardsContainer");
const nextBtn = document.getElementById("nextCardBtn");

let mobileCards = [];
let mobileIndex = 0;

  
/* ============================
   NUEVA FUNCIÓN MÓVIL
   (CARTAS PEQUEÑAS EN HORIZONTAL)
============================ */

function showNextMobileCard() {
  if (mobileIndex >= mobileCards.length) return;

  const card = mobileCards[mobileIndex];

  // --- Carta pequeña horizontal ---
  const wrapper = document.createElement("div");
  wrapper.className = "mobile-card-small";

  const img = document.createElement("img");
  img.src = cardImages[card.title];
  img.className = "mobile-card-small-img";

  const btn = document.createElement("button");
  btn.className = "mobile-card-small-btn";
  btn.textContent = "LEER CARTA";

  // --- Vista ampliada ---
  const overlay = document.createElement("div");
  overlay.className = "mobile-card-overlay";
  overlay.style.display = "none";

  overlay.innerHTML = `
    <div class="mobile-card-overlay-content">
      <h3>${card.type}: ${card.title}</h3>
      <p>${card.teaching}</p>
      <p><em>${card.action}</em></p>
      <p><strong>${card.affirmation}</strong></p>
      <button class="close-overlay">VOLVER</button>
    </div>
  `;

  // Abrir vista ampliada
  btn.onclick = () => {
    overlay.style.display = "flex";
  };

  // Cerrar vista ampliada
  overlay.querySelector(".close-overlay").onclick = () => {
    overlay.style.display = "none";
  };

  wrapper.appendChild(img);
  wrapper.appendChild(btn);
  wrapper.appendChild(overlay);

  // Añadir carta pequeña al contenedor horizontal
  mobileContainer.appendChild(wrapper);

  mobileIndex++;

  // --- Si ya están las 3 cartas ---
  if (mobileIndex === mobileCards.length) {
    nextBtn.style.display = "none";

    // Mostrar frase vibracional
    const phrase = generateInsightPhrase(
      mobileCards[0],
      mobileCards[1],
      mobileCards[2]
    );

    const msg = document.getElementById("atmaMessage");
    msg.innerHTML = `
      Tus cartas del Tarot Atma dicen...<br><br>
      <span class="insight-phrase">${phrase}</span>
    `;
    msg.style.display = "block";

    // --- Botón "Barajar de nuevo" ---
    const restartBtn = document.createElement("button");
    restartBtn.className = "restart-btn-mobile";
    restartBtn.textContent = "Barajar de nuevo";

    restartBtn.onclick = () => {
      resetMobileView();
    };

    msg.appendChild(restartBtn);
  }
}


  
/* ============================
   RESET MÓVIL
============================ */

function resetMobileView() {
  document.getElementById("headerSection").style.display = "flex";
  document.getElementById("oracleImageWrapper").style.display = "flex";
  document.getElementById("cardsRow").style.display = "flex";

  mobileContainer.style.display = "none";
  mobileContainer.innerHTML = "";
  nextBtn.style.display = "none";

  mobileIndex = 0;
  mobileCards = [];

  const restartBtn = document.querySelector(".restart-btn");
  if (restartBtn) restartBtn.remove();

  document.getElementById("atmaMessage").style.display = "none";
}

nextBtn.addEventListener("click", showNextMobileCard);

/* ============================
   BOTÓN BARAJAR
============================ */

document.getElementById("drawBtn").addEventListener("click", () => {
  document.getElementById("atmaMessage").style.display = "none";

  const current = getRandomCard("current");
  const block = getRandomCard("block");
  const potential = getRandomCard("potential");


  /* ======== MÓVIL ======== */
  if (window.innerWidth <= 600) {
    document.getElementById("headerSection").style.display = "none";
    document.getElementById("oracleImageWrapper").style.display = "none";
    document.getElementById("cardsRow").style.display = "none";

    mobileCards = [
      { type: "Energía actual", ...current },
      { type: "Bloqueo", ...block },
      { type: "Potencial", ...potential }
    ];

    mobileIndex = 0;
    mobileContainer.innerHTML = "";
    mobileContainer.style.display = "flex";

    nextBtn.style.display = "block";
    nextBtn.textContent = "Revelar siguiente";

    // Mostrar solo la primera carta
    showNextMobileCard();

    return;
  }
  /* ======== PC ======== */
  document.getElementById("cardsRow").style.display = "flex";
  renderCard("card-current", current);
  renderCard("card-block", block);
  renderCard("card-potential", potential);

  const phrase = generateInsightPhrase(current, block, potential);

  const msg = document.getElementById("atmaMessage");
  msg.innerHTML = `
    Tus cartas del Tarot Atma dicen...<br><br>
    <span class="insight-phrase">${phrase}</span>
  `;
  msg.style.display = "block";
});

  
</script>
</body>
</html>
